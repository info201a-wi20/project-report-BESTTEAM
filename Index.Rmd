---
title: "Report"
author: "Andrew Liu, Carol Wang, Luna_Lan, Sarah Hu, Ziyi An"
date: "2/25/2020"
output: html_document
---

```{r setup, include=FALSE}
library(knitr)
source("analysis.R")
library("knitr")
corr <- correlation
```

## Problem Domain

Recently, influenced by COVIS-19 pneumonia, Chinese state-backed importers of natural gas are examining if they can provisionally halt contracts for the supercooled fuel, as the COVIS-19 outbreak depresses energy demand in the world’s second-largest economy. This temporary cancellation of contracts has created headaches for natural gas suppliers and made them concerned about the future.

Since natural gas is one of the three most important fossil fuels, the natural gas market could have a large impact on the global economy. Therefore, our group will discuss the correlation between the spreading of COVIS-19 and two important economic indicators, price of natural gas and NBEV stock, in the final project. NBEV stock is an important but relatively risky stock which could reflect the stability of the stock market. If the price of NBEV goes down, it’s probably because investors become concerned about the future economy in the short run.

Only very basic statistical knowledge will be involved in our report and it should be straightforward for every reader!


### The List of Questions Covered:

#### 1. Based on the data set, does the number of coronovirus pneumonia cases confirmed have no effect on the price of natural gas?

Since the outbreak of coronavirus has raised concerns of suppliers of natural gas, it is meaningful to explore the relationship between natural gas prices and confirmed cases number.

In this question, we use simple regression model and correlation to solve this problem.The data of COVIS-19 virus spreading is from the World Health Organization(https://www.kaggle.com/sudalairajkumar/novel-corona-virus-2019-dataset) and the data of natural gas prices is from datahub(https://datahub.io/core/natural-gas). They are all credible and sources. 

Under the simple regression model, we can get a graph of the number of confirmed cases and the price of natural gas.
```{r echo=FALSE}
reg
```

The correlation of these two factor is `r corr`,which is a quite small number, indicating that based on the data we obtained, natural gas price seems to be unrelated with the number of cases confirmed statistically. Even though this conclusion seems to contradict with the economic expectation, it is explainable because currently, we have very limited statistics of coronavirus spreading. Restricted by the small pool of data, it is possible that our conclusion is not consistent with the long-term trend.


#### 2. 



#### 3. 



#### 4. Based on the data set, how is each country dealing with this issue? 
**(i.e.: What is the comparison of the recovery rate among all countries/regions?)**

This question is interesting because we will then be able to gain a sense of how people are taking control of the issue and which country could potentially have a better medical system or technology.

I first pull the data of Conoravirus case by the getVirus function we created. I also get the data of the world map through wbstats package. Then I added iso3c code to each data set so they can join later.(There is no iso3c code for "Mainland China" so I combined the data from Mainland china, Hongkong, Macau and Taiwan into "China".) In order to get the recover rate among each countries/region, I then grouped the countries/region, used the summary feature in dplyr package to sum up the confirmed cases and also the recover cases. Then I added a column calculating the percentage of recover rate. After this, I used left.join to combine the virus dataset with the world map dataset, then use ggplot to create a visualization for it.

```{r recovery, echo=FALSE}
plot(recover_compare)
```

**Result:** 

The darker the color, the lower the recovery rate is. For countries/regions that have over 100 confirmed cases, Italy, South Korea, Canada, the US, and China are five countries that have a lower recovery rate. China, with its vast confirmed case (1201794) and its 15% recovery rate, has a moderate level of control policies and significant medical resources support. However, countries like Italy with its 1.02% recovery rate, South Korea with its 8% recovery rate, Canada with its 10.77% recovery rate, and the US with its 12.81% recovery rate should pay more attention to this issue and provide more medical resources for their citizens.

**Evaluation:** 
According to the coronavirus data, it is clear that because the outbreak of the virus in different countries takes time, every region are at a different stage right now. We are still in the middle of the epidemic, and the data are updating every day, which means that the results we got now are not the latest and might not valid in the future.


#### 5. Based on the data set, are we dealing with this issue better or worse based on the current medical technologies?

This question is interesting because by looking at the trend of these two data, we are able to see whether the current treatment is getting more effective or not.

Here, the death rate is the number of death devided by the number of confirmed cases. The recover rate is the number of recovered cases devided by the confirmed cases. The question is analyzed by comparing the death rate nad recover rate overtime.

This question is approached by comparing the overall death rate to the overall recover rate over time after the virus has been discovered. With the data of the confirmed, death, and recovered number of each day for every region, I summarised the number of confirmed, death, and recovered by each date, then I calculated the death rate and recovered rate by dividing the number of death on that day, the number of recovered on that day, by the number of confirmed by that day.

The following graph is made by mapping the two rates to date by timeline. The green line represents the recover rate and the red line represents the death rate.


```{r death_vs_recovery, echo=FALSE}
death_vs_recover
```

We also tried to understand which region has the highest death rate and recover rate. We did that by grouping the dataset by the country and summing the number of confirmed of the latest record and calcultae the death and recover rate. The result is that `r max_death_region` has the max death rate of `r paste0(round(max_death_rate, 0), "%")` and `r max_recover_region` has the max recover rate of `r paste0(max_recover_rate, "%")`.

Based on the graph, we can observe that the recover rate has a decrease before Febuary and then it shows a trend of growth, where the death rate has been fluctuating at the same level. We can conclude that even though the death rate is not getting lower, we are still doing well on the recover rate.

There are some limitations to our data that is worth discussing. First, the max recover rate is `r paste0(max_recover_rate, "%")` in `r max_recover_region`, where there is only one confirmed case and the person has recovered, it is one of the edge cases that does not signify any information about the medical system. Second, the data used for the graph is the sum from all regions where each region are in various stages of the breakout. It is not the best practice for analysing how we are doing on the medical system. Third, the amount of data is still limited given that the break out was not far ago. More data is needed for making a conclusion.

However, baase on the current data, we can see that the death rate of `r paste0(round(death_latest, 0), "%")`, and the recover rate of `r paste0(round(recover_latest, 0), "%")` are approaching to the right estimated value and more and more people are getting recovered from the virus. While there is no medical treatment targetting this virus, there is no need to worry about it too much if the right actions are made to protect people from getting infected.

## Data Description
We are using two datasets: one is the novel coronavirus dataset which contains the records of value for the confirmed case, recovered case and death case from different districts over the world by date; another is the economic change dataset which contains the value for natural gas trade and the US stock market value within the same time zone as the coronavirus. 

We got the novel coronavirus dataset from [Kaggle](https://www.kaggle.com/sudalairajkumar/novel-corona-virus-2019-dataset). The data originally comes from Johns Hopkins University. One note about this dataset is that it’s time series data.

```{r echo=FALSE}
kable(virus_sample)
```

In the above table: Confirmed, Death, Recovered are the number of the Confirmed, Death, Recovered found in Province.State of Country.Region on that Date. The unit is person.

The data of stock trade is a table with date matched to a summary of trades that happened on that day. It includes, high, low, volume, open price, and closing price. It is retrieved from the [yahoo finance api](https://rapidapi.com/apidojo/api/yahoo-finance1), end point "stock/get-histories" and parsed into an expected format. It is joined with the data of natrual gas by date. The data of natrual gas is retrived from [datahub](https://datahub.io/core/natural-gas), that is collected from U.S. Energy Information Administration EIA Dataset.

```{r echo=FALSE}
kable(stock_sample)
```

In the above table: low, high, close, open is the lowest price, highest price, closing price, and opening price in USD of "NBEV" on that date, price is the price of natural gas in USD. Volume is the volume of trade of "NBEV" on that date.
